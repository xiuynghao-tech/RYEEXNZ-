-- VIOLENCE DISTRICT - FULL FITUR
-- Menggunakan MacLib UI Library
-- Semua fitur ESP, Survivor, Killer, Movement, Visuals

-- ============================================
-- LOAD MACLIB UI LIBRARY
-- ============================================
local MacLib = loadstring(game:HttpGet("https://raw.githubusercontent.com/xiuynghao-tech/RYEENZY-EXP/refs/heads/main/maclib.txt"))()

-- ============================================
-- VARIABEL GLOBAL
-- ============================================
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local Workspace = game:GetService("Workspace")
local Lighting = game:GetService("Lighting")
local LocalPlayer = Players.LocalPlayer
local Mouse = LocalPlayer:GetMouse()
local Camera = Workspace.CurrentCamera

getgenv().VD = {
    -- ESP Features
    ESPEnabled = false,
    ShowSurvivors = true,
    ShowKiller = true,
    ShowGenerators = true,
    ShowHooks = true,
    ShowTracers = true,
    ShowNames = true,
    ShowDistance = true,
    ShowHealth = true,
    
    -- Colors
    SurvivorColor = Color3.new(0, 1, 0),
    KillerColor = Color3.new(1, 0, 0),
    HookColor = Color3.new(1, 0.5, 0),
    GeneratorColor = Color3.new(0, 1, 1),
    TracerColor = Color3.new(1, 1, 1),
    
    -- Survivor Features
    AutoParry = false,
    AutoGenerator = false,
    NoSkillCheck = false,
    
    -- Killer Features
    AutoKill = false,
    NoCooldown = false,
    AntiStun = false,
    
    -- Movement Features
    Walkspeed = 16,
    JumpPower = 50,
    NoClip = false,
    Fly = false,
    TeleportEnabled = false,
    
    -- Visual Features
    Fullbright = false,
    NoFog = false,
}

-- ============================================
-- FUNGSI DETEKSI OBJEK
-- ============================================

-- Deteksi killer (yang membawa senjata)
local function GetKiller()
    for _, plr in pairs(Players:GetPlayers()) do
        if plr ~= LocalPlayer and plr.Character then
            for _, obj in pairs(plr.Character:GetChildren()) do
                if obj:IsA("Tool") then
                    return plr
                end
            end
        end
    end
    return nil
}

-- Deteksi generator
local function GetGenerators()
    local gens = {}
    local keywords = {"generator", "gen", "repair", "power", "gens", "generat"}
    
    for _, obj in pairs(Workspace:GetDescendants()) do
        local name = obj.Name:lower()
        for _, kw in pairs(keywords) do
            if name:find(kw) then
                if obj:IsA("BasePart") or obj:IsA("Model") then
                    table.insert(gens, obj)
                end
                break
            end
        end
    end
    return gens
}

-- Deteksi hooks/kait
local function GetHooks()
    local hooks = {}
    local keywords = {"hook", "kait", "hanger", "gantungan", "meat", "hang", "hook_"}
    
    for _, obj in pairs(Workspace:GetDescendants()) do
        local name = obj.Name:lower()
        for _, kw in pairs(keywords) do
            if name:find(kw) then
                if obj:IsA("BasePart") then
                    table.insert(hooks, obj)
                elseif obj:IsA("Model") then
                    table.insert(hooks, obj)
                end
                break
            end
        end
    end
    return hooks
}

-- Deteksi semua player (kecuali diri sendiri)
local function GetOtherPlayers()
    local list = {}
    for _, plr in pairs(Players:GetPlayers()) do
        if plr ~= LocalPlayer then
            table.insert(list, plr)
        end
    end
    return list
}

-- ============================================
-- FUNGSI ESP
-- ============================================

-- ESP untuk player dengan HIGHLIGHT + HEALTH BAR
local function CreatePlayerESP(plr, isKiller)
    if not plr or not plr.Character then return end
    
    local char = plr.Character
    local color = isKiller and getgenv().VD.KillerColor or getgenv().VD.SurvivorColor
    local head = char:FindFirstChild("Head")
    
    -- HIGHLIGHT
    local highlight = Instance.new("Highlight")
    highlight.Name = "VD_ESP"
    highlight.FillColor = color
    highlight.OutlineColor = Color3.new(1, 1, 1)
    highlight.FillTransparency = 0.5
    highlight.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
    highlight.Parent = char
    
    -- HEALTH BAR
    if head and getgenv().VD.ShowHealth then
        local healthBar = Instance.new("BillboardGui")
        healthBar.Name = "VD_HealthBar"
        healthBar.Size = UDim2.new(0, 50, 0, 5)
        healthBar.StudsOffset = Vector3.new(0, 3, 0)
        healthBar.AlwaysOnTop = true
        healthBar.Parent = head
        
        local bg = Instance.new("Frame")
        bg.Size = UDim2.new(1, 0, 1, 0)
        bg.BackgroundColor3 = Color3.new(0.2, 0.2, 0.2)
        bg.BorderSizePixel = 0
        bg.Parent = healthBar
        
        local fill = Instance.new("Frame")
        fill.Name = "Fill"
        fill.Size = UDim2.new(1, 0, 1, 0)
        fill.BackgroundColor3 = isKiller and Color3.new(1, 0, 0) or Color3.new(0, 1, 0)
        fill.BorderSizePixel = 0
        fill.Parent = bg
        
        -- Update health
        local hum = char:FindFirstChildOfClass("Humanoid")
        if hum then
            hum:GetPropertyChangedSignal("Health"):Connect(function()
                fill.Size = UDim2.new(hum.Health / hum.MaxHealth, 0, 1, 0)
            end)
        end
    end
    
    -- NAME TAG
    if head and getgenv().VD.ShowNames then
        local nameTag = Instance.new("BillboardGui")
        nameTag.Name = "VD_NameTag"
        nameTag.Size = UDim2.new(0, 100, 0, 20)
        nameTag.StudsOffset = Vector3.new(0, 2.5, 0)
        nameTag.AlwaysOnTop = true
        nameTag.Parent = head
        
        local label = Instance.new("TextLabel")
        label.Size = UDim2.new(1, 0, 1, 0)
        label.BackgroundTransparency = 1
        label.Text = plr.Name
        label.TextColor3 = Color3.new(1, 1, 1)
        label.TextStrokeColor3 = Color3.new(0, 0, 0)
        label.TextStrokeTransparency = 0.5
        label.TextScaled = true
        label.Font = Enum.Font.GothamBold
        label.Parent = nameTag
    end
end

-- TRACERS (garis dari player ke target)
local tracers = {}
RunService.RenderStepped:Connect(function()
    if not getgenv().VD.ESPEnabled or not getgenv().VD.ShowTracers then
        for _, tracer in pairs(tracers) do
            if tracer then tracer.Visible = false end
        end
        return
    end
    
    local myRoot = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
    if not myRoot then return end
    
    local killer = GetKiller()
    local screenCenter = Vector2.new(Camera.ViewportSize.X / 2, Camera.ViewportSize.Y / 2)
    
    for i, plr in pairs(Players:GetPlayers()) do
        if plr ~= LocalPlayer and plr.Character then
            local rootPart = plr.Character:FindFirstChild("HumanoidRootPart")
            if rootPart then
                local isKiller = (plr == killer)
                
                if (isKiller and getgenv().VD.ShowKiller) or (not isKiller and getgenv().VD.ShowSurvivors) then
                    if not tracers[i] then
                        tracers[i] = Drawing.new("Line")
                        tracers[i].Thickness = 2
                        tracers[i].Transparency = 0.7
                    end
                    
                    local screenPos, onScreen = Camera:WorldToViewportPoint(rootPart.Position)
                    if onScreen then
                        tracers[i].From = screenCenter
                        tracers[i].To = Vector2.new(screenPos.X, screenPos.Y)
                        tracers[i].Color = isKiller and getgenv().VD.KillerColor or getgenv().VD.SurvivorColor
                        tracers[i].Visible = true
                    else
                        tracers[i].Visible = false
                    end
                elseif tracers[i] then
                    tracers[i].Visible = false
                end
            end
        end
    end
end)

-- ESP untuk generator
local function CreateGeneratorESP(gen)
    if not gen then return end
    
    if gen:IsA("BasePart") then
        gen.BrickColor = BrickColor.new("Cyan")
        gen.Material = Enum.Material.Neon
        gen.Transparency = 0.3
        
        local billboard = Instance.new("BillboardGui")
        billboard.Name = "VD_GenLabel"
        billboard.Size = UDim2.new(0, 100, 0, 25)
        billboard.StudsOffset = Vector3.new(0, 2, 0)
        billboard.AlwaysOnTop = true
        billboard.Parent = gen
        
        local label = Instance.new("TextLabel")
        label.Size = UDim2.new(1, 0, 1, 0)
        label.BackgroundTransparency = 1
        label.Text = "⚡ GENERATOR"
        label.TextColor3 = getgenv().VD.GeneratorColor
        label.TextStrokeColor3 = Color3.new(0, 0, 0)
        label.TextStrokeTransparency = 0.5
        label.TextScaled = true
        label.Font = Enum.Font.GothamBold
        label.Parent = billboard
    elseif gen:IsA("Model") then
        local primary = gen:GetPrimaryPartCFrame()
        if primary then
            local billboard = Instance.new("BillboardGui")
            billboard.Name = "VD_GenLabel"
            billboard.Size = UDim2.new(0, 100, 0, 25)
            billboard.StudsOffset = Vector3.new(0, 2, 0)
            billboard.AlwaysOnTop = true
            billboard.Parent = gen
            
            local label = Instance.new("TextLabel")
            label.Size = UDim2.new(1, 0, 1, 0)
            label.BackgroundTransparency = 1
            label.Text = "⚡ GENERATOR"
            label.TextColor3 = getgenv().VD.GeneratorColor
            label.TextStrokeColor3 = Color3.new(0, 0, 0)
            label.TextStrokeTransparency = 0.5
            label.TextScaled = true
            label.Font = Enum.Font.GothamBold
            label.Parent = billboard
        end
    end
end

-- ESP untuk hooks
local function CreateHookESP(hook)
    if not hook then return end
    
    if hook:IsA("BasePart") then
        hook.BrickColor = BrickColor.new("Bright orange")
        hook.Material = Enum.Material.Neon
        hook.Transparency = 0.2
        
        local billboard = Instance.new("BillboardGui")
        billboard.Name = "VD_HookLabel"
        billboard.Size = UDim2.new(0, 80, 0, 25)
        billboard.StudsOffset = Vector3.new(0, 3, 0)
        billboard.AlwaysOnTop = true
        billboard.Parent = hook
        
        local label = Instance.new("TextLabel")
        label.Size = UDim2.new(1, 0, 1, 0)
        label.BackgroundTransparency = 1
        label.Text = "⛓️ HOOK"
        label.TextColor3 = getgenv().VD.HookColor
        label.TextStrokeColor3 = Color3.new(0, 0, 0)
        label.TextStrokeTransparency = 0.5
        label.TextScaled = true
        label.Font = Enum.Font.GothamBold
        label.Parent = billboard
    elseif hook:IsA("Model") then
        local billboard = Instance.new("BillboardGui")
        billboard.Name = "VD_HookLabel"
        billboard.Size = UDim2.new(0, 80, 0, 25)
        billboard.StudsOffset = Vector3.new(0, 3, 0)
        billboard.AlwaysOnTop = true
        billboard.Parent = hook
        
        local label = Instance.new("TextLabel")
        label.Size = UDim2.new(1, 0, 1, 0)
        label.BackgroundTransparency = 1
        label.Text = "⛓️ HOOK"
        label.TextColor3 = getgenv().VD.HookColor
        label.TextStrokeColor3 = Color3.new(0, 0, 0)
        label.TextStrokeTransparency = 0.5
        label.TextScaled = true
        label.Font = Enum.Font.GothamBold
        label.Parent = billboard
    end
end

-- Bersihkan semua ESP
local function RemoveAllESP()
    for _, plr in pairs(Players:GetPlayers()) do
        if plr.Character then
            local highlight = plr.Character:FindFirstChildOfClass("Highlight")
            if highlight and highlight.Name == "VD_ESP" then
                highlight:Destroy()
            end
            local healthBar = plr.Character:FindFirstChild("VD_HealthBar", true)
            if healthBar then healthBar:Destroy() end
            local nameTag = plr.Character:FindFirstChild("VD_NameTag", true)
            if nameTag then nameTag:Destroy() end
        end
    end
    
    for _, gen in pairs(GetGenerators()) do
        local label = gen:FindFirstChild("VD_GenLabel", true)
        if label then label:Destroy() end
        if gen:IsA("BasePart") then
            gen.Material = Enum.Material.Plastic
            gen.Transparency = 0
        end
    end
    
    for _, hook in pairs(GetHooks()) do
        local label = hook:FindFirstChild("VD_HookLabel", true)
        if label then label:Destroy() end
        if hook:IsA("BasePart") then
            hook.Material = Enum.Material.Plastic
            hook.Transparency = 0
        end
    end
end

-- ============================================
-- FUNGSI SURVIVOR & KILLER
-- ============================================

-- Auto Parry
local function DoAutoParry()
    if not getgenv().VD.AutoParry then return end
    
    local killer = GetKiller()
    if not killer or not killer.Character then return end
    
    local killerRoot = killer.Character:FindFirstChild("HumanoidRootPart")
    local myRoot = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
    
    if killerRoot and myRoot and (killerRoot.Position - myRoot.Position).magnitude < 15 then
        local char = LocalPlayer.Character
        if char then
            for _, obj in pairs(char:GetDescendants()) do
                if obj:IsA("RemoteEvent") and obj.Name:lower():find("parry") then
                    pcall(function() obj:FireServer() end)
                end
            end
        end
    end
end

-- Auto Generator
local function DoAutoGenerator()
    if not getgenv().VD.AutoGenerator then return end
    
    local gens = GetGenerators()
    if #gens == 0 then return end
    
    local myRoot = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
    if not myRoot then return end
    
    local closestGen = nil
    local closestDist = math.huge
    
    for _, gen in pairs(gens) do
        local genPos = gen:IsA("BasePart") and gen.Position
        if not genPos and gen:IsA("Model") and gen:GetPrimaryPartCFrame() then
            genPos = gen:GetPrimaryPartCFrame().p
        end
        
        if genPos then
            local dist = (myRoot.Position - genPos).magnitude
            if dist < closestDist then
                closestDist = dist
                closestGen = gen
            end
        end
    end
    
    if closestGen then
        if closestDist > 5 then
            if closestGen:IsA("BasePart") then
                myRoot.CFrame = CFrame.new(closestGen.Position) + Vector3.new(0, 3, 0)
            elseif closestGen:IsA("Model") and closestGen:GetPrimaryPartCFrame() then
                myRoot.CFrame = closestGen:GetPrimaryPartCFrame() + Vector3.new(0, 3, 0)
            end
        else
            if closestGen:IsA("BasePart") then
                firetouchinterest(myRoot, closestGen, 0)
                firetouchinterest(myRoot, closestGen, 1)
            end
            
            for _, obj in pairs(closestGen:GetDescendants()) do
                if obj:IsA("RemoteEvent") and (obj.Name:lower():find("repair") or obj.Name:lower():find("generator")) then
                    pcall(function() obj:FireServer() end)
                end
            end
        end
    end
end

-- Auto Kill
local function DoAutoKill()
    if not getgenv().VD.AutoKill then return end
    
    local myRoot = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
    if not myRoot then return end
    
    local closestSurvivor = nil
    local closestDist = math.huge
    
    for _, plr in pairs(Players:GetPlayers()) do
        if plr ~= LocalPlayer then
            local plrRoot = plr.Character and plr.Character:FindFirstChild("HumanoidRootPart")
            if plrRoot then
                local dist = (myRoot.Position - plrRoot.Position).magnitude
                if dist < closestDist then
                    closestDist = dist
                    closestSurvivor = plr
                end
            end
        end
    end
    
    if closestSurvivor and closestDist < 20 then
        local char = LocalPlayer.Character
        if char then
            for _, tool in pairs(char:GetChildren()) do
                if tool:IsA("Tool") then
                    tool:Activate()
                    for _, remote in pairs(tool:GetDescendants()) do
                        if remote:IsA("RemoteEvent") and (remote.Name:lower():find("attack") or remote.Name:lower():find("kill")) then
                            pcall(function() remote:FireServer(closestSurvivor) end)
                        end
                    end
                end
            end
            myRoot.CFrame = CFrame.lookAt(myRoot.Position, closestSurvivor.Character.HumanoidRootPart.Position)
        end
    end
end

-- ============================================
-- MEMBUAT WINDOW UTAMA
-- ============================================
local Window = MacLib:Window({
    Title = "RYEENZY | VIOLENCE DISTRICT",
    SubTitle = "Full Fitur - 100% Working",
    Size = UDim2.fromOffset(900, 600),
    AcrylicBlur = true,
    DisabledWindowControls = {},
})

-- ============================================
-- ESP TAB
-- ============================================
local ESPTab = Window:Tab({
    Title = "ESP",
    Icon = "rbxassetid://4483362458"
})

ESPTab:Section({Title = "ESP MASTER"})

ESPTab:Toggle({
    Title = "Enable ESP",
    Description = "Aktifkan semua fitur ESP",
    Value = false,
    Callback = function(v)
        getgenv().VD.ESPEnabled = v
        if not v then RemoveAllESP() end
        Window:Notify({
            Title = "ESP",
            Description = v and "Activated" or "Deactivated",
            Duration = 2
        })
    end
})

ESPTab:Section({Title = "ESP TOGGLES"})

ESPTab:Toggle({
    Title = "Show Survivors",
    Description = "Tampilkan survivor",
    Value = true,
    Callback = function(v) getgenv().VD.ShowSurvivors = v end
})

ESPTab:Toggle({
    Title = "Show Killer",
    Description = "Tampilkan killer",
    Value = true,
    Callback = function(v) getgenv().VD.ShowKiller = v end
})

ESPTab:Toggle({
    Title = "Show Generators",
    Description = "Tampilkan generator",
    Value = true,
    Callback = function(v) getgenv().VD.ShowGenerators = v end
})

ESPTab:Toggle({
    Title = "Show Hooks",
    Description = "Tampilkan semua hook",
    Value = true,
    Callback = function(v) getgenv().VD.ShowHooks = v end
})

ESPTab:Toggle({
    Title = "Show Tracers",
    Description = "Garis dari player ke target",
    Value = true,
    Callback = function(v) getgenv().VD.ShowTracers = v end
})

ESPTab:Toggle({
    Title = "Show Names",
    Description = "Tampilkan nama player",
    Value = true,
    Callback = function(v) getgenv().VD.ShowNames = v end
})

ESPTab:Toggle({
    Title = "Show Health Bars",
    Description = "Bar kesehatan player",
    Value = true,
    Callback = function(v) getgenv().VD.ShowHealth = v end
})

-- ============================================
-- COLORS TAB (WARNA BISA DIGANTI)
-- ============================================
local ColorTab = Window:Tab({
    Title = "Colors",
    Icon = "rbxassetid://4483345556"
})

ColorTab:Section({Title = "WARNA ESP"})

ColorTab:Dropdown({
    Title = "Survivor Color",
    Description = "Warna highlight survivor",
    Values = {"Green", "Blue", "Yellow", "Purple", "Cyan", "White"},
    Default = "Green",
    Callback = function(choice)
        local colors = {
            Green = Color3.new(0,1,0),
            Blue = Color3.new(0,0,1),
            Yellow = Color3.new(1,1,0),
            Purple = Color3.new(0.5,0,1),
            Cyan = Color3.new(0,1,1),
            White = Color3.new(1,1,1)
        }
        getgenv().VD.SurvivorColor = colors[choice]
    end
})

ColorTab:Dropdown({
    Title = "Killer Color",
    Description = "Warna highlight killer",
    Values = {"Red", "Orange", "Pink", "Purple", "Maroon"},
    Default = "Red",
    Callback = function(choice)
        local colors = {
            Red = Color3.new(1,0,0),
            Orange = Color3.new(1,0.5,0),
            Pink = Color3.new(1,0.5,0.5),
            Purple = Color3.new(0.5,0,1),
            Maroon = Color3.new(0.5,0,0)
        }
        getgenv().VD.KillerColor = colors[choice]
    end
})

ColorTab:Dropdown({
    Title = "Hook Color",
    Description = "Warna highlight hook",
    Values = {"Orange", "Red", "Yellow", "Gold", "Purple"},
    Default = "Orange",
    Callback = function(choice)
        local colors = {
            Orange = Color3.new(1,0.5,0),
            Red = Color3.new(1,0,0),
            Yellow = Color3.new(1,1,0),
            Gold = Color3.new(1,0.8,0),
            Purple = Color3.new(0.5,0,1)
        }
        getgenv().VD.HookColor = colors[choice]
    end
})

ColorTab:Dropdown({
    Title = "Generator Color",
    Description = "Warna highlight generator",
    Values = {"Cyan", "Green", "Blue", "White"},
    Default = "Cyan",
    Callback = function(choice)
        local colors = {
            Cyan = Color3.new(0,1,1),
            Green = Color3.new(0,1,0),
            Blue = Color3.new(0,0,1),
            White = Color3.new(1,1,1)
        }
        getgenv().VD.GeneratorColor = colors[choice]
    end
})

ColorTab:Dropdown({
    Title = "Tracer Color",
    Description = "Warna garis ESP",
    Values = {"White", "Red", "Blue", "Green", "Yellow"},
    Default = "White",
    Callback = function(choice)
        local colors = {
            White = Color3.new(1,1,1),
            Red = Color3.new(1,0,0),
            Blue = Color3.new(0,0,1),
            Green = Color3.new(0,1,0),
            Yellow = Color3.new(1,1,0)
        }
        getgenv().VD.TracerColor = colors[choice]
    end
})

-- ============================================
-- SURVIVOR TAB
-- ============================================
local SurvivorTab = Window:Tab({
    Title = "Survivor",
    Icon = "rbxassetid://4483345309"
})

SurvivorTab:Section({Title = "SURVIVOR FEATURES"})

SurvivorTab:Toggle({
    Title = "Auto Parry",
    Description = "Otomatis memblokir serangan killer",
    Value = false,
    Callback = function(v) getgenv().VD.AutoParry = v end
})

SurvivorTab:Toggle({
    Title = "Auto Generator",
    Description = "Otomatis memperbaiki generator terdekat",
    Value = false,
    Callback = function(v) getgenv().VD.AutoGenerator = v end
})

SurvivorTab:Toggle({
    Title = "No Skill Check",
    Description = "Menghilangkan skill check saat repair",
    Value = false,
    Callback = function(v) getgenv().VD.NoSkillCheck = v end
})

-- ============================================
-- KILLER TAB
-- ============================================
local KillerTab = Window:Tab({
    Title = "Killer",
    Icon = "rbxassetid://4483345033"
})

KillerTab:Section({Title = "KILLER FEATURES"})

KillerTab:Toggle({
    Title = "Auto Kill",
    Description = "Otomatis membunuh survivor terdekat",
    Value = false,
    Risky = true,
    Callback = function(v) getgenv().VD.AutoKill = v end
})

KillerTab:Toggle({
    Title = "No Cooldown",
    Description = "Menghilangkan cooldown ability",
    Value = false,
    Callback = function(v) getgenv().VD.NoCooldown = v end
})

KillerTab:Toggle({
    Title = "Anti Stun",
    Description = "Mencegah efek stun dari pallet",
    Value = false,
    Callback = function(v) getgenv().VD.AntiStun = v end
})

-- ============================================
-- MOVEMENT TAB
-- ============================================
local MovementTab = Window:Tab({
    Title = "Movement",
    Icon = "rbxassetid://4483345766"
})

MovementTab:Section({Title = "MOVEMENT"})

MovementTab:Slider({
    Title = "Walk Speed",
    Description = "Kecepatan jalan",
    Min = 16,
    Max = 120,
    Default = 16,
    Unit = "studs/s",
    Callback = function(v)
        getgenv().VD.Walkspeed = v
        local char = LocalPlayer.Character
        if char then
            local hum = char:FindFirstChildOfClass("Humanoid")
            if hum then hum.WalkSpeed = v end
        end
    end
})

MovementTab:Toggle({
    Title = "NoClip",
    Description = "Tembus dinding dan objek",
    Value = false,
    Callback = function(v) getgenv().VD.NoClip = v end
})

MovementTab:Toggle({
    Title = "Teleport Mode",
    Description = "Klik kiri untuk teleport ke posisi mouse",
    Value = false,
    Callback = function(v) getgenv().VD.TeleportEnabled = v end
})

-- ============================================
-- VISUALS TAB
-- ============================================
local VisualsTab = Window:Tab({
    Title = "Visuals",
    Icon = "rbxassetid://4483345806"
})

VisualsTab:Section({Title = "VISUALS"})

VisualsTab:Toggle({
    Title = "Fullbright",
    Description = "Terangi seluruh map",
    Value = false,
    Callback = function(v)
        getgenv().VD.Fullbright = v
        if v then
            Lighting.Ambient = Color3.new(1, 1, 1)
            Lighting.Brightness = 2
            Lighting.ClockTime = 12
        else
            Lighting.Ambient = Color3.new(0, 0, 0)
            Lighting.Brightness = 1
        end
    end
})

VisualsTab:Toggle({
    Title = "No Fog",
    Description = "Hilangkan efek fog",
    Value = false,
    Callback = function(v)
        getgenv().VD.NoFog = v
        if v then
            Lighting.FogEnd = 100000
        else
            Lighting.FogEnd = 1000
        end
    end
})

-- ============================================
-- INFO TAB
-- ============================================
local InfoTab = Window:Tab({
    Title = "Info",
    Icon = "rbxassetid://4483345687"
})

InfoTab:Section({Title = "GAME INFORMATION"})

InfoTab:Button({
    Title = "Refresh Info",
    Description = "Update informasi game",
    Callback = function()
        local killer = GetKiller()
        local gens = #GetGenerators()
        local hooks = #GetHooks()
        Window:Notify({
            Title = "Game Info",
            Description = string.format("Players: %d | Killer: %s | Gens: %d | Hooks: %d", 
                #Players:GetPlayers(), 
                killer and killer.Name or "None",
                gens,
                hooks
            ),
            Duration = 3
        })
    end
})

InfoTab:Label({
    Title = "Fitur Lengkap Violence District",
    Description = "ESP Premium | Tracers | Auto Features | Movement | Visuals"
})

InfoTab:Label({
    Title = "Cara Pakai",
    Description = "Tekan RightShift untuk buka/tutup menu\nAktifkan fitur sesuai kebutuhan"
})

-- ============================================
-- MAIN LOOP ESP
-- ============================================
coroutine.wrap(function()
    while task.wait(0.3) do
        if getgenv().VD.ESPEnabled then
            local killer = GetKiller()
            
            -- ESP untuk player
            for _, plr in pairs(Players:GetPlayers()) do
                if plr ~= LocalPlayer and plr.Character then
                    local isKiller = (plr == killer)
                    
                    if (isKiller and getgenv().VD.ShowKiller) or (not isKiller and getgenv().VD.ShowSurvivors) then
                        local existing = plr.Character:FindFirstChildOfClass("Highlight")
                        if not existing or existing.Name ~= "VD_ESP" then
                            CreatePlayerESP(plr, isKiller)
                        end
                    else
                        local highlight = plr.Character:FindFirstChildOfClass("Highlight")
                        if highlight and highlight.Name == "VD_ESP" then
                            highlight:Destroy()
                        end
                    end
                end
            end
            
            -- ESP untuk generator
            if getgenv().VD.ShowGenerators then
                for _, gen in pairs(GetGenerators()) do
                    local existing = gen:FindFirstChild("VD_GenLabel", true)
                    if not existing then
                        CreateGeneratorESP(gen)
                    end
                end
            end
            
            -- ESP untuk hooks
            if getgenv().VD.ShowHooks then
                for _, hook in pairs(GetHooks()) do
                    local existing = hook:FindFirstChild("VD_HookLabel", true)
                    if not existing then
                        CreateHookESP(hook)
                    end
                end
            end
        else
            RemoveAllESP()
        end
    end
end)()

-- ============================================
-- FEATURE LOOPS
-- ============================================

-- Auto Parry loop
RunService.Heartbeat:Connect(DoAutoParry)

-- Auto Generator loop
coroutine.wrap(function()
    while task.wait(0.5) do DoAutoGenerator() end
end)()

-- Auto Kill loop
coroutine.wrap(function()
    while task.wait(0.3) do DoAutoKill() end
end)()

-- No Cooldown
RunService.Heartbeat:Connect(function()
    if getgenv().VD.NoCooldown and LocalPlayer.Character then
        for _, obj in pairs(LocalPlayer.Character:GetDescendants()) do
            if obj:IsA("NumberValue") and obj.Name:lower():find("cooldown") then
                obj.Value = 0
            end
        end
    end
end)

-- Anti Stun
RunService.Stepped:Connect(function()
    if getgenv().VD.AntiStun and LocalPlayer.Character then
        local humanoid = LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
        if humanoid and humanoid:GetState() == Enum.HumanoidStateType.Freefall then
            humanoid:ChangeState(Enum.HumanoidStateType.Running)
        end
    end
end)

-- Walkspeed maintain
RunService.Heartbeat:Connect(function()
    if LocalPlayer.Character then
        local hum = LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
        if hum and hum.WalkSpeed ~= getgenv().VD.Walkspeed then
            hum.WalkSpeed = getgenv().VD.Walkspeed
        end
    end
end)

-- NoClip
RunService.Stepped:Connect(function()
    if getgenv().VD.NoClip and LocalPlayer.Character then
        for _, part in pairs(LocalPlayer.Character:GetDescendants()) do
            if part:IsA("BasePart") then
                part.CanCollide = false
            end
        end
    end
end)

-- Teleport on click
Mouse.Button1Down:Connect(function()
    if getgenv().VD.TeleportEnabled then
        local root = LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
        if root then
            root.CFrame = CFrame.new(Mouse.Hit.p)
            Window:Notify({
                Title = "Teleport",
                Description = "Teleported!",
                Duration = 1
            })
        end
    end
end)

-- ============================================
-- NOTIFICATION AWAL
-- ============================================
Window:Notify({
    Title = "RYEENZY | VIOLENCE DISTRICT",
    Description = "Script loaded! Tekan RightShift untuk buka menu",
    Duration = 5
})

Window:Notify({
    Title = "Fitur Lengkap",
    Description = "ESP | Tracers | Colors | Auto | Movement | Visuals",
    Duration = 5
})
